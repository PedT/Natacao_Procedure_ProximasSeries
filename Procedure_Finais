
CREATE OR REPLACE PROCEDURE proximas_series_finais
	IS
	BEGIN
	INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '4'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = t3.MIN(t3.tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL 
	  
		INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '5'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = (SELECT DISTINCT TOP 2 tempo FROM SERIE_PART ORDER BY tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL
	  
	  		INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '3'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = (SELECT DISTINCT TOP 3 tempo FROM SERIE_PART ORDER BY tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL
	  
	  		INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '6'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = (SELECT DISTINCT TOP 4 tempo FROM SERIE_PART ORDER BY tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL
	  
	  		INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '2'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = (SELECT DISTINCT TOP 5 tempo FROM SERIE_PART ORDER BY tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL
	
			INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '7'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = (SELECT DISTINCT TOP 6 tempo FROM SERIE_PART ORDER BY tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL
	  
	  		INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '1'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = (SELECT DISTINCT TOP 7 tempo FROM SERIE_PART ORDER BY tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL
	  
	  		INSERT INTO SERIE_PART
	  (DataHoraSerie, NomeParticipante, raia)
	  SELECT t1.*, t2.*, '8'
	  FROM SERIE t1, PARTICIPANTE t2, SERIE_PART t3
	  WHERE t3.tempo = (SELECT DISTINCT TOP 8 tempo FROM SERIE_PART ORDER BY tempo) AND t3.SERIE.tipo = 'SEMIFINAL' AND t1.tipo = 'FINAL' AND t1 = t3.SERIE AND t2 = t3.PARTICIPANTE AND t1.PROVA.id_prova = t3.SERIE.PROVA.id_prova AND t3.tempo IS NOT NULL
	  
	  
	  
	  
	  
END
